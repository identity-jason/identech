<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><title>Feeling Lazy - Identity Technology (again)</title><meta name="description" content="I'm currently working on a project where I need to toggle transitions into a set - not an uncommon requirement,&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://github.com/identity-jason/identech/feeling-lazy/"><link rel="alternate" type="application/atom+xml" href="https://github.com/identity-jason/identech/feed.xml"><link rel="alternate" type="application/json" href="https://github.com/identity-jason/identech/feed.json"><meta property="og:title" content="Feeling Lazy"><meta property="og:site_name" content="Identity Technology (again)"><meta property="og:description" content="I'm currently working on a project where I need to toggle transitions into a set - not an uncommon requirement,&hellip;"><meta property="og:url" content="https://github.com/identity-jason/identech/feeling-lazy/"><meta property="og:type" content="article"><style>:root{--primary-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--secondary-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}</style><link rel="stylesheet" href="https://github.com/identity-jason/identech/assets/css/fontawesome-all.min.css?v=bbcde81f26378440dac4c3d195714389"><link rel="stylesheet" href="https://github.com/identity-jason/identech/assets/css/style.css?v=dd2f5302461b6031e60971f8134aab44"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://github.com/identity-jason/identech/feeling-lazy/"},"headline":"Feeling Lazy","datePublished":"2012-08-06T18:28","dateModified":"2022-01-09T11:32","description":"I'm currently working on a project where I need to toggle transitions into a set - not an uncommon requirement,&hellip;","author":{"@type":"Person","name":"identity_jason"},"publisher":{"@type":"Organization","name":"identity_jason"}}</script></head><body class="is-preload"><div id="wrapper"><div id="main"><div class="inner"><header id="header"><a class="logo" href="https://github.com/identity-jason/identech/"><strong>Identity Technology (again)</strong></a></header><article class="post"><header class="main post__header"><time datetime="2012-08-06T18:28" class="post__date">August 6, 2012</time><h1>Feeling Lazy</h1></header><div class="post__inner post__entry"><p>I'm currently working on a project where I need to toggle transitions into a set - not an uncommon requirement, but one where I'm getting tired of using the GUI to locate my current "volunteer" user and set the required attributes to true in order to transition the user into the set, before repeating the process to transition them back out by going back into the GUI, retrieving the correct user, locating the attribute and clearing the checkbox.</p><p>As I'm feeling lazy (and it's something I've been meaning to do for a while) I've put together a quick powershell script to locate the user and then do these operations for me - setting the nominated attribute to be true, before immediately setting it back to false.</p><p>[wpfilebase tag=file path='toggle_bool.ps1' /]</p><pre>#-----------------------------------------------------------------------------------------------------------<restore-line-break>#-- <restore-line-break>#-- Toggle_bool.ps1<restore-line-break>#-- <restore-line-break>#-- Locates a person by displayname and switches the nominated atribute to true and then to false<restore-line-break>#-- <restore-line-break>#-----------------------------------------------------------------------------------------------------------<restore-line-break><restore-line-break>#-----------------------------------------------------------------------------------------------------------<restore-line-break> set-variable -name URI -value "http://localhost:5725/resourcemanagementservice" -option constant <restore-line-break>#-----------------------------------------------------------------------------------------------------------<restore-line-break> if($args.count -ne 2) {    <restore-line-break>    write-host ""<restore-line-break>    write-host "usage: toggle.ps1 &lt;username&gt; &lt;attribute&gt;"<restore-line-break>    throw "missing one or more parameters"<restore-line-break>    }<restore-line-break><restore-line-break> $userName = $args[0]<restore-line-break> $attribute = $args[1]<restore-line-break><restore-line-break> if(@(get-pssnapin | where-object {$_.Name -eq "FIMAutomation"} ).count -eq 0) {add-pssnapin FIMAutomation}<restore-line-break> #clear-host<restore-line-break> $curObject = export-fimconfig -uri $URI `<restore-line-break>                               –onlyBaseResources `<restore-line-break>                               -customconfig ("/Person[DisplayName='$userName']")<restore-line-break><restore-line-break> if($curObject -eq $null) {throw "userName not found!"} <restore-line-break> $objectType       = $curObject.ResourceManagementObject.ObjectType <restore-line-break> $objectIdentifier = $curObject.ResourceManagementObject.ObjectIdentifier <restore-line-break><restore-line-break>     $importChange = New-Object Microsoft.ResourceManagement.Automation.ObjectModel.ImportChange<restore-line-break>    $importChange.Operation = 1<restore-line-break>    $importChange.AttributeName = $attribute<restore-line-break>    $importChange.AttributeValue = $true    <restore-line-break>    $importChange.FullyResolved = 1<restore-line-break>    $importChange.Locale = "Invariant"<restore-line-break><restore-line-break>    $importObject = New-Object Microsoft.ResourceManagement.Automation.ObjectModel.ImportObject<restore-line-break>    $importObject.ObjectType = $objectType<restore-line-break>    $importObject.TargetObjectIdentifier = $objectIdentifier<restore-line-break>    $importObject.SourceObjectIdentifier = $objectIdentifier<restore-line-break>    $importObject.State = 1 <restore-line-break>    $importObject.Changes = (,$importChange)<restore-line-break><restore-line-break>    $importObject | Import-FIMConfig -uri $URI<restore-line-break><restore-line-break>    $importChange = New-Object Microsoft.ResourceManagement.Automation.ObjectModel.ImportChange<restore-line-break>    $importChange.Operation = 1<restore-line-break>    $importChange.AttributeName = $attribute<restore-line-break>    $importChange.AttributeValue = $false<restore-line-break>    $importChange.FullyResolved = 1<restore-line-break>    $importChange.Locale = "Invariant"<restore-line-break><restore-line-break>    $importObject = New-Object Microsoft.ResourceManagement.Automation.ObjectModel.ImportObject<restore-line-break>    $importObject.ObjectType = $objectType<restore-line-break>    $importObject.TargetObjectIdentifier = $objectIdentifier<restore-line-break>    $importObject.SourceObjectIdentifier = $objectIdentifier<restore-line-break>    $importObject.State = 1 <restore-line-break>    $importObject.Changes = (,$importChange)<restore-line-break><restore-line-break>    $importObject | Import-FIMConfig -uri $URI<restore-line-break><restore-line-break>#-----------------------------------------------------------------------------------------------------------<restore-line-break> trap <restore-line-break> { <restore-line-break>    Write-Host "`nError: $($_.Exception.Message)`n" -foregroundcolor white -backgroundcolor darkred<restore-line-break>    Exit 1<restore-line-break> }<restore-line-break>#-----------------------------------------------------------------------------------------------------------</restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></pre></div><footer class="post__inner post__footer"><p class="post__last-updated">This article was updated on January 9, 2022</p><div class="post__share"><h3>Share post:</h3></div><div class="post__bio"><div><h3><a href="https://github.com/identity-jason/identech/authors/identity_jason/" class="invert" rel="author">identity_jason</a></h3></div></div></footer></article></div></div><div id="sidebar"><div class="inner"><nav id="menu"><header class="major"><h2>Menu</h2></header></nav><section><header class="major"><h2>Get in touch</h2></header><p>Sed varius enim lorem ullamcorper dolore aliquam aenean ornare velit lacus,ac varius enim lorem ullamcorper dolore. Proin sed aliqu facilisis ante interdum. Sed nulla amet lorem feugiat tempus aliquam.</p><ul class="contact"><li class="icon solid fa-envelope"><a href="#">information@untitled.tld</a></li><li class="icon solid fa-phone">(000) 000-0000</li><li class="icon solid fa-home">1234 Somewhere Road #8254<br>Nashville, TN 00000-0000</li></ul></section><footer id="footer"><p class="copyright">&copy; Editorial 2 - All rights reserved<br>Design by: <a href="https://html5up.net" target="_blank" rel="noopener">HTML5 UP</a>, Powered by Publii</p></footer></div></div></div><script src="https://github.com/identity-jason/identech/assets/js/jquery.min.js?v=7c14a783dfeb3d238ccd3edd840d82ee"></script><script src="https://github.com/identity-jason/identech/assets/js/browser.min.js?v=c07298dd19048a8a69ad97e754dfe8d0"></script><script src="https://github.com/identity-jason/identech/assets/js/breakpoints.min.js?v=81a479eb099e3b187613943b085923b8"></script><script src="https://github.com/identity-jason/identech/assets/js/util.min.js?v=cbdaf7c20ac2883c77ae23acfbabd47e"></script><script src="https://github.com/identity-jason/identech/assets/js/main.min.js?v=448f4c9d4b4c374766a1cb76c3d88048"></script><script>var images=document.querySelectorAll("img[loading]");for(var i=0;i<images.length;i++){if(images[i].complete){images[i].classList.add("is-loaded")}else{images[i].addEventListener("load",function(){this.classList.add("is-loaded")},false)}};</script></body></html>