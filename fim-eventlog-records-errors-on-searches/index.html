<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><title>FIM EventLog records errors on searches - Identity Technology (again)</title><meta name="description" content="I’m currently debugging some custom workflow activities and updating the logging code so it produces more useful information (apparently my&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://github.com/identity-jason/identech/fim-eventlog-records-errors-on-searches/"><link rel="alternate" type="application/atom+xml" href="https://github.com/identity-jason/identech/feed.xml"><link rel="alternate" type="application/json" href="https://github.com/identity-jason/identech/feed.json"><meta property="og:title" content="FIM EventLog records errors on searches"><meta property="og:site_name" content="Identity Technology (again)"><meta property="og:description" content="I’m currently debugging some custom workflow activities and updating the logging code so it produces more useful information (apparently my&hellip;"><meta property="og:url" content="https://github.com/identity-jason/identech/fim-eventlog-records-errors-on-searches/"><meta property="og:type" content="article"><style>:root{--primary-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--secondary-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}</style><link rel="stylesheet" href="https://github.com/identity-jason/identech/assets/css/fontawesome-all.min.css?v=bbcde81f26378440dac4c3d195714389"><link rel="stylesheet" href="https://github.com/identity-jason/identech/assets/css/style.css?v=dd2f5302461b6031e60971f8134aab44"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://github.com/identity-jason/identech/fim-eventlog-records-errors-on-searches/"},"headline":"FIM EventLog records errors on searches","datePublished":"2015-06-03T02:56","dateModified":"2022-01-09T11:32","description":"I’m currently debugging some custom workflow activities and updating the logging code so it produces more useful information (apparently my&hellip;","author":{"@type":"Person","name":"identity_jason"},"publisher":{"@type":"Organization","name":"identity_jason"}}</script></head><body class="is-preload"><div id="wrapper"><div id="main"><div class="inner"><header id="header"><a class="logo" href="https://github.com/identity-jason/identech/"><strong>Identity Technology (again)</strong></a></header><article class="post"><header class="main post__header"><time datetime="2015-06-03T02:56" class="post__date">June 3, 2015</time><h1>FIM EventLog records errors on searches</h1></header><div class="post__inner post__entry"><p>I’m currently debugging some custom workflow activities and updating the logging code so it produces more useful information (apparently my ‘development’ error codes aren’t human readable enough!) and noticed that I was getting lots of ‘KeyNotFound’ exceptions in the event log.</p><p>Microsoft.ResourceManagement.WebServices.Exceptions.UnwillingToPerformException: Other ---&gt; System.Collections.Generic.KeyNotFoundException: The given key was not present in the dictionary.</p><p>After much digging through my code I spotted that this was actually being generated whenever I read from FIM in the Portal and while it was a relief to know that my workflow code was off the hook I didn’t really want to leave this in place and cluttering up the eventlog.</p><p>It looks like this was introduced during one of the hotfix releases (4.1.3496 is mentioned in the article I’ve linked to below) when additional Portal configuration was introduced to allow the Advanced Search option to be turned off – this means that my local FIM installation was actually attempting to locate an attribute on the Portal Configuration that I didn’t have in my schema which was the cause of the KeyNotFound exceptions I was finding.</p><p>The steps to fix is are fairly simple as follows (Steps taken from the referenced documents - not my own work - see below for links)</p><p>To enable the configuration and remove the <strong>Advanced Search</strong> link, follow these steps:</p><ol><li>In <strong>Administration</strong>, click <strong>Schema Management</strong>, and then click <strong>All Attributes</strong>.</li><li>Create a new Boolean attribute that is named "HideAdvancedSearchLink."</li><li>In <strong>All Bindings</strong>, create a new binding for the <strong>HideAdvancedSearchLink</strong> attribute to the <strong>Portal Configuration</strong> resource, and then click <strong>Finish</strong> to save the binding.</li><li>Create a new Management Policy Rule (MPR) to allow for changes to the new binding in the portal configuration. To do this, use the following configuration for the new MPR:<strong>Display Name:</strong> Administrators can modify the <strong>HideAdvancedSearchLink</strong> attribute in the Portal Configuration resource<br><strong>Type:</strong> Request<br><strong>Disabled:</strong> False<br><strong>Specific Set of Requestors:</strong> All Administrators<br><strong>Operation:</strong> Modify a single-valued attribute<br><strong>Permissions:</strong> Grants permission<br><strong>Target Resource Definition Before Request:</strong> All Basic Configuration Objects<br><strong>Target Resource Definition After Request:</strong> All Basic Configuration Objects<br><strong>Resource Attributes:</strong> Select specific attributes: <strong>HideAdvancedSearchLink</strong></li><li>Reset Internet Information Services (IIS), and then restart the FIM service.</li><li>In <strong>Administration</strong>, click <strong>Portal Configuration</strong>, and then click <strong>Extended Attributes</strong>. You should see the<strong>HideAdvancedSearchLink</strong> attribute together with the other extended attributes.</li><li>Click to select the <strong>HideAdvancedSearchLink</strong> check box, and then click <strong>Submit</strong> to enable the hiding of the <strong>Advanced Search</strong> link.</li><li>Verify that the <strong>Advanced Search</strong> link is not available in the list views. For example, check the following list views:</li><li>My DGs</li><li>My DG Memberships</li><li>Management Policy Rules</li></ol><p>Once I had this implemented and FIM restarted the errors were removed and I was left with the exceptions of my own making again – yay I think!</p><p>Links for the above are to:</p><p>Blog Post - <a title="http://www.networksteve.com/windows/topic.php/Error_raised_in_the_event_log_when_browsing_the_portal/?TopicId=61333&amp;Posts=3" href="http://www.networksteve.com/windows/topic.php/Error_raised_in_the_event_log_when_browsing_the_portal/?TopicId=61333&amp;Posts=3">http://www.networksteve.com/windows/topic.php/Error_raised_in_the_event_log_when_browsing_the_portal/?TopicId=61333&amp;Posts=3</a></p><p>KB Article -<a title="https://support.microsoft.com/en-us/kb/2906832/en-us" href="https://support.microsoft.com/en-us/kb/2906832/en-us">https://support.microsoft.com/en-us/kb/2906832/en-us</a></p></div><footer class="post__inner post__footer"><p class="post__last-updated">This article was updated on January 9, 2022</p><div class="post__share"><h3>Share post:</h3></div><div class="post__bio"><div><h3><a href="https://github.com/identity-jason/identech/authors/identity_jason/" class="invert" rel="author">identity_jason</a></h3></div></div></footer></article></div></div><div id="sidebar"><div class="inner"><nav id="menu"><header class="major"><h2>Menu</h2></header></nav><footer id="footer"><p class="copyright">&copy; Editorial 2 - All rights reserved<br>Design by: <a href="https://html5up.net" target="_blank" rel="noopener">HTML5 UP</a>, Powered by Publii</p></footer></div></div></div><script src="https://github.com/identity-jason/identech/assets/js/jquery.min.js?v=7c14a783dfeb3d238ccd3edd840d82ee"></script><script src="https://github.com/identity-jason/identech/assets/js/browser.min.js?v=c07298dd19048a8a69ad97e754dfe8d0"></script><script src="https://github.com/identity-jason/identech/assets/js/breakpoints.min.js?v=81a479eb099e3b187613943b085923b8"></script><script src="https://github.com/identity-jason/identech/assets/js/util.min.js?v=cbdaf7c20ac2883c77ae23acfbabd47e"></script><script src="https://github.com/identity-jason/identech/assets/js/main.min.js?v=448f4c9d4b4c374766a1cb76c3d88048"></script><script>var images=document.querySelectorAll("img[loading]");for(var i=0;i<images.length;i++){if(images[i].complete){images[i].classList.add("is-loaded")}else{images[i].addEventListener("load",function(){this.classList.add("is-loaded")},false)}};</script></body></html>